/*
 * oled96.h
 *
 *  Created on: 30 Jul 2015
 *      Author: Mark
 */

#ifndef OLED96_H_
#define OLED96_H_

#include <stdint.h>
#include "main.h"
#include "i2c_master.h"
typedef uint16_t uint;
typedef uint8_t uchar;

//#define Write_Address 0x78/*slave addresses with write*/
//#define Read_Address 0x79/*slave addresses with read*/
//#define SLAVE_ADDRESS 0x3C
#define SLAVE_ADDRESS 0x78
#define OLED_WIDTH 128
#define OLED_HEIGHT 64

// define the below to use a screen buffer, note that this allocates a
// one bit per pixel static buffer in RAM.
#define USE_SCREEN_BUFFER

#define Start_column	0x00
#define Start_page		0x00
#define	StartLine_set	0x00

#define I2C_TRANSMIT(length, data) I2cMasterBlockingWrite(length, SLAVE_ADDRESS, data)
// the busy test is not required on STM32
#define I2C_NOTREADY() (0)

#define WRITE_I2C_DATA(length, data) I2cMasterBlockingWriteWithDC(length, SLAVE_ADDRESS, 0x40, data)

void OledTestLoop(void);
void OledOverlayBitmaps(const uint8_t base[], const uint8_t white_overlay[], const uint8_t black_overlay[], uint8_t xpos, uint8_t ypos);
void OledDisplayBitmap(const uint8_t bitmap[], uint8_t xpos, uint8_t ypos);
void OledInit(void);
void OledCls();
void OledAdjContrast(int8_t adjustment_amt); // plus or minus amt.
void OledDisplayString(char *string);
void OledDisplayDigit(uint8_t digit_value);
void OledDisplayChar(char character);
void OledGotoXY(uint8_t x, uint8_t y);

#ifdef USE_SCREEN_BUFFER
/* C lays out multi dimensional arrays as row-major:
0,0 | 0,1 | 0,2 | 0,3
----+-----+-----+----
1,0 | 1,1 | 1,2 | 1,3
----+-----+-----+----
2,0 | 2,1 | 2,2 | 2,3

0,0 | 0,1 | 0,2 | 0,3 | 1,0 | 1,1 | 1,2 | 1,3 | 2,0 | 2,1 | 2,2 | 2,3

Our OLED (and for that matter 3310 lcd) accept writes in order of a
naturally incrementing X position, so the most effective
access method is screen_buffer[Y][X]
therefore we declare the buffer as single dimension and use a #define to text-replace
and make our code more readable.
*/

uint8_t _screen_buffer[OLED_HEIGHT/8 * OLED_WIDTH];
#define SCREEN_BUFFER(x,y) _screen_buffer[y * OLED_WIDTH + x]
#define LCDRefresh(x)
#define LCDService()

#endif

#endif /* OLED96_H_ */
